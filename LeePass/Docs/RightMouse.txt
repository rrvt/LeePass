Here's how to add a right-click popup menu to a CEdit control in an MFC dialog box:

• Handle the WM_CONTEXTMENU message:
  • Use the Class Wizard or manually add an ON_WM_CONTEXTMENU message handler to your dialog class.
  • The framework calls this handler when the user right-clicks within the window.

    void CYourDialog::OnContextMenu(CWnd* pWnd, CPoint point)
    {
        if (pWnd->GetDlgCtrlID() == IDC_EDIT1) // Check if right-click is on the CEdit control
        {
            CMenu menu;
            menu.LoadMenu(IDR_POPUP_MENU); // Load the menu resource

            CMenu* pPopupMenu = menu.GetSubMenu(0);
            if (pPopupMenu)
            {
                pPopupMenu->TrackPopupMenu(TPM_LEFTALIGN | TPM_RIGHTBUTTON, point.x, point.y, this);
            }
        }
        else
        {
            CDialogEx::OnContextMenu(pWnd, point); // Handle context menu for other controls
        }
    }

• Create a menu resource:
  • In the Resource View, create a new menu resource (e.g., IDR_POPUP_MENU).
  • Add the desired menu items (e.g., "Cut," "Copy," "Paste") with appropriate command IDs.

• Add command handlers for menu items:
  • Use the Class Wizard or manually add command handlers (e.g., ON_COMMAND) for the menu item IDs in your dialog class.
  • Implement the corresponding actions (e.g., using CEdit::Cut(), CEdit::Copy(), CEdit::Paste()).

    void CYourDialog::OnEditCut()
    {
        GetDlgItem(IDC_EDIT1)->SendMessage(WM_CUT);
    }

    void CYourDialog::OnEditCopy()
    {
        GetDlgItem(IDC_EDIT1)->SendMessage(WM_COPY);
    }

    void CYourDialog::OnEditPaste()
    {
        GetDlgItem(IDC_EDIT1)->SendMessage(WM_PASTE);
    }

    // Add ON_COMMAND handlers in message map
    BEGIN_MESSAGE_MAP(CYourDialog, CDialogEx)
        ON_WM_CONTEXTMENU()
        ON_COMMAND(ID_EDIT_CUT, &CYourDialog::OnEditCut)
        ON_COMMAND(ID_EDIT_COPY, &CYourDialog::OnEditCopy)
        ON_COMMAND(ID_EDIT_PASTE, &CYourDialog::OnEditPaste)
    END_MESSAGE_MAP()

• Ensure the CEdit control has an ID:
  • In the dialog editor, make sure your CEdit control has a unique ID (e.g., IDC_EDIT1).

Generative AI is experimental.


